<activity-summary-info flex="none" ng-if="$ctrl.item.mode === 'view'" class="{{$ctrl.item.activity.status}}">
</activity-summary-info>
    <fieldset ng-disabled="$ctrl.item.mode === 'view'">
        <md-list flex="none" class="md-dense slim-input bg-grey-200"
                 ng-if="$ctrl.item.mode !== 'view'">
            <md-list-item>
                <md-input-container class="md-block no-message" md-no-float layout="row">
                    <md-icon flex="none" md-svg-src="{{$ctrl.item.activity.sportUrl}}"></md-icon>
                    <md-select flex name="sport" class="icon" required
                               ng-model="$ctrl.item.activity.sport"
                               ng-model-options="{ getterSetter: true }"
                               ng-change="$ctrl.changeParam()"
                               ng-disabled="!$ctrl.item.isCreator && !$ctrl.item.isMyCoach">
                        <md-option ng-repeat="type in $ctrl.item.types | filter:{enabled: true} track by type.id"
                                   value="{{type.id}}">{{'sport.'+type.code | translate}}
                        </md-option>
                    </md-select>
                    <div ng-messages="$ctrl.form.sport.$error" role="alert">
                        <div ng-message-exp="['required']"
                             translate="form.required">
                        </div>
                        <div ng-message-exp="['minlength', 'maxlength']"
                             translate="form.rangeStr" translate-values="{min:2, max:100}">
                        </div>
                    </div>
                </md-input-container>
            </md-list-item>
            <md-list-item ng-if="$ctrl.item.activity.categoriesList.length > 0">
                <md-input-container class="md-block no-message" md-no-float>
                    <md-icon class="material-icons">tune</md-icon>
                    <md-select ng-model="$ctrl.item.activity.category" required=""
                               md-no-asterisk="false"
                               placeholder="Укажите категорию"
                               ng-model-options="{ getterSetter: true }"
                               ng-change="$ctrl.changeParam()"
                               ng-disabled="!$ctrl.item.isCreator && !$ctrl.item.isMyCoach"
                               name="category"
                               class="icon">
                        <md-option
                                ng-repeat="category in $ctrl.item.activity.categoriesList |
                                filter:{activityTypeId: $ctrl.item.activity.sport}:true track by category.id"
                                value="{{category.id}}">{{'category.'+category.code | translate}}
                        </md-option>
                    </md-select>
                    <div ng-messages="$ctrl.form.category.$error" role="alert">
                        <div ng-message="required"
                             translate="form.required">
                        </div>
                    </div>
                </md-input-container>
            </md-list-item>
            <md-list-item ng-if="$ctrl.item.activity.sport">
                <md-icon class="material-icons" style="margin-right: 20px">format_list_numbered</md-icon>
                <p>Структурированное задание</p>
                <md-switch class="md-secondary md-primary"
                           ng-model="$ctrl.item.structuredMode" md-invert>
            </md-list-item>
            <md-list-item layout="row" layout-align="start center">
                <md-input-container flex="50" class="no-message" md-no-float>
                    <md-icon flex="none" class="material-icons" style="left: 0px">today</md-icon>
                    <md-datepicker flex="auto" ng-model="$ctrl.item.activity._dateStart"
                                   ng-change="$ctrl.changeParam()"
                                   name="dateStart" md-hide-icons="calendar"
                                   ng-disabled="!$ctrl.item.isCreator && !$ctrl.item.isMyCoach"
                                   style="margin-left: 42px"></md-datepicker>
                    <div ng-messages="$ctrl.form.dateStart.$error" role="alert">
                        <div ng-message="needPermissionForFeature"
                             translate="calendar.needPermissionForFeature">
                        </div>
                    </div>
                </md-input-container>
                <div flex="5"></div><!--
                <md-input-container flex="45" class="no-message" md-no-float>
                    <input type="time" name="uri" class=""
                           ng-model="$ctrl.item.activity.header.startTimeStamp"
                           ng-disabled="false">
                </md-input-container>-->
            </md-list-item>
            <md-button class="md-fab md-mini md-primary" aria-label="Use Android">
                <md-icon class="material-icons">edit</md-icon>
            </md-button>
        </md-list>
        <md-list flex="none" class="md-dense slim-input bg-grey-100">
            <!--<md-subheader class="bg-grey-100">Задание</md-subheader>-->
            <md-list-item>
                <p class="md-caption" style="color: #455A64">Задание</p>
                <p class="md-caption md-dark md-secondary" ng-class="{'md-inactive': !$ctrl.ftpMode}"
                   style="text-align: right; margin-right: 8px">%ПАНО: {{$ctrl.ftpMode ? 'ВЫКЛ ' : 'ВКЛ'}}</p>
                <md-switch class="md-secondary md-primary" ng-true-value="0" ng-false-value="1"
                           ng-inital="ftp = $ctrl.ftpMode" ng-model="ftp" ng-change="$ctrl.ftpModeChange(ftp)" md-invert>
                </md-switch>
            </md-list-item>
            <md-list-item ng-if="!$ctrl.item.activity.sport">
                <p class="md-body-1">Для ввода задания укажите вид спорта и тип тренировки</p>
            </md-list-item>
            <md-list-item class="bg-grey-100" ng-if="($ctrl.item.structuredMode || $ctrl.item.activity.structured) && $ctrl.item.activity.sport">
                <table md-table
                       md-row-select="$ctrl.options.rowSelection"
                       multiple="{{$ctrl.options.multiSelect}}"
                       ng-model="$ctrl.selected">
                    <thead ng-if="!$ctrl.options.decapitate" md-head>
                        <tr md-row>
                            <th md-column><span></span></th>
                            <th md-column show style="min-width: 50px"><span>Ед.изм</span></th>
                            <th md-column md-numeric style="min-width: 80px"><span>План</span></th>
                            <th md-column md-numeric style="min-width: 55px"><span>Факт</span></th>
                            <th md-column md-numeric style="min-width: 50px"><span>Вып</span></th>
                        </tr>
                    </thead>
                    <tbody md-body>
                        <tr md-row ng-repeat="measure in ['movingDuration','distance'] track by $index">
                            <td md-cell>
                                <md-icon md-svg-src="assets/icon/{{measure}}.svg" class="dark-active"></md-icon>
                            </td>
                            <td md-cell><span>{{measure | measureUnit:$ctrl.sport | translate}}</span></td>
                            <td md-cell>
                                <span ng-if="$ctrl.item.activity.intervalPW[$ctrl.structuredMeasure[measure].approx]">~</span>
                                <span>{{$ctrl.item.activity.intervalPW[$ctrl.structuredMeasure[measure].length] | measureCalc:$ctrl.sport:measure}}</span>
                            </td>
                            <td md-cell></td>
                            <td md-cell></td>
                        </tr>
                    </tbody>
                </table>
            </md-list-item>
            <md-list-item class="bg-grey-100" ng-if="($ctrl.item.structuredMode || $ctrl.item.activity.structured) && $ctrl.item.activity.sport">
                <md-icon class="material-icons" style="margin-right: 20px">format_list_numbered</md-icon>
                <p>{{$ctrl.item.activity.intervalP.length}} сегм</p>
                <md-icon ng-click="angular.noop()" class="md-secondary material-icons">keyboard_arrow_right</md-icon>

            </md-list-item>
            <md-list-item class="bg-grey-100" ng-if="!($ctrl.item.structuredMode || $ctrl.item.activity.structured) && $ctrl.item.activity.sport">
                <md-table-container>
                    <table md-table
                           md-row-select="$ctrl.options.rowSelection"
                           multiple="{{$ctrl.options.multiSelect}}"
                           ng-model="$ctrl.selected">
                        <thead ng-if="!$ctrl.options.decapitate" md-head>
                        <tr md-row>
                            <th md-column><span></span></th>
                            <th md-column hide><span>Показатель(ед.изм)</span></th>
                            <th md-column show style="min-width: 50px"><span>Ед.изм</span></th>
                            <th md-column md-numeric style="min-width: 80px"><span>План</span></th>
                            <th md-column md-numeric style="min-width: 55px"><span>Факт</span></th>
                            <th md-column md-numeric style="min-width: 50px"><span>Вып</span></th>
                        </tr>
                        </thead>
                        <tbody md-body>
                        <tr md-row
                            ng-repeat="measure in $ctrl.plan | toArray | orderBy:'order' | filter:search track by measure.$key">
                            <td md-cell>
                                <md-icon md-svg-src="assets/icon/{{measure.$key}}.svg" class="dark-active"></md-icon>
                            </td>
                            <td md-cell show>
                                <span ng-if="$ctrl.isFTP() && $ctrl.isInterval(measure.$key)">{{'%ПАНО' | translate}}</span>
                                <span ng-if="!($ctrl.isFTP() && $ctrl.isInterval(measure.$key))">{{measure.$key | measureUnit:$ctrl.sport | translate}}</span>
                            </td>

                            <td md-cell>
                                <md-input-container>
                                    <input ng-if="$ctrl.isInterval(measure.$key)" measure-input
                                           ng-model="measure"
                                           name="plan_{{::measure.$key}}"
                                           measure="measure.$key"
                                           ng-attr-sport={{$ctrl.sport}} interval="true"
                                           ftp-mode="$ctrl.isFTP()" ftp="$ctrl.getFTP(measure.$key,$ctrl.sport)"
                                           ng-change="$ctrl.changeValue(measure.$key)"
                                           ng-disabled="!$ctrl.item.isCreator && !$ctrl.item.isMyCoach">
                                    <input ng-if="!$ctrl.isInterval(measure.$key)" measure-input
                                           name="plan_{{::measure.$key}}"
                                           ng-model="measure.durationValue"
                                           measure="measure.$key"
                                           ng-attr-sport={{$ctrl.sport}} interval="false"
                                           ftp-mode="$ctrl.isFTP()" ftp="$ctrl.getFTP(measure.$key,$ctrl.sport)"
                                           ng-change="$ctrl.changeValue(measure.$key)"
                                           ng-disabled="!$ctrl.item.isCreator && !$ctrl.item.isMyCoach">
                                </md-input-container>
                            </td>
                            <td md-cell ng-if="!$ctrl.isFTP()">
                                <md-input-container>
                                    <input ng-model="$ctrl.actual[measure.$key][$ctrl.valueType[measure.$key]]"
                                           name="actual_{{::measure.$key}}" measure-input
                                           measure="measure.$key"
                                           ng-attr-sport={{$ctrl.sport}} interval="false"
                                           ftp-mode="$ctrl.isFTP()" ftp="$ctrl.getFTP(measure.$key,$ctrl.sport)"
                                           ng-change="$ctrl.changeValue(measure.$key)"
                                           ng-disabled="$ctrl.item.activity.actualDataIsImported">
                                </md-input-container>
                            </td>
                            <td md-cell ng-if="$ctrl.isFTP()">
                                <md-input-container>
                                    <input ng-if="$ctrl.isInterval(measure.$key)" measure-input
                                           ng-model="$ctrl.actual[measure.$key]['intensityByFtp']"
                                           name="actual_{{::measure.$key}}"
                                           measure="measure.$key"
                                           ng-attr-sport={{$ctrl.sport}} interval="false"
                                           ftp-mode="$ctrl.isFTP()" ftp="$ctrl.getFTP(measure.$key,$ctrl.sport)"
                                           ng-change="$ctrl.changeValue(measure.$key)"
                                           ng-disabled="$ctrl.item.activity.actualDataIsImported">
                                    <input ng-if="!$ctrl.isInterval(measure.$key)" measure-input
                                           ng-model="$ctrl.actual[measure.$key]['value']"
                                           name="actual_{{::measure.$key}}"
                                           measure="measure.$key"
                                           ng-attr-sport={{$ctrl.sport}} interval="false"
                                           ftp-mode="$ctrl.isFTP()" ftp="$ctrl.getFTP(measure.$key,$ctrl.sport)"
                                           ng-change="$ctrl.changeValue(measure.$key)"
                                           ng-disabled="$ctrl.item.activity.actualDataIsImported">
                                </md-input-container>
                            </td>
                            <td md-cell>
                                {{$ctrl.percentComplete[measure.$key] | percent}}
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </md-table-container>
            </md-list-item>
            <md-list-item style="margin-top: 16px; margin-bottom: 40px" ng-if="$ctrl.item.activity.sport">
                <md-input-container flex class="md-block no-message">
                    <md-icon class="material-icons">event_note</md-icon>
                    <label translate="Установка тренера" class="icon"></label>
                    <textarea ng-model="$ctrl.item.activity.intervalPW.trainersPrescription"
                              ng-change="$ctrl.changeParam()"
                              ng-disabled="!$ctrl.item.isCreator && !$ctrl.item.isMyCoach"
                              class="icon" name="trainersPrescription"
                              rows="1"></textarea>
                </md-input-container>
            </md-list-item>
        </md-list>
    </fieldset>

<div flex="auto" class="bg-grey-100"></div>