
    <section class="overview" ng-if="$ctrl.mode !== 'post' && ($ctrl.activity.hasDetails || $ctrl.isLoadingDetails)"
             flex="auto" layout="column" hide show-gt-sm>
        <md-toolbar flex="none" class="md-hue-3">
            <div class="md-toolbar-tools">
                <md-menu md-position-mode="target-right target" md-offset="0 60" md-position-mode="target-right target">
                    <md-button class="md-icon-button" ng-click="$mdOpenMenu($event)"
                               aria-label="User">
                        <md-icon class="material-icons">menu</md-icon>
                    </md-button>
                    <md-menu-content width="4">
                        <md-menu-item>
                            <md-button ng-click="$ctrl.onDelete()" ng-disabled="$ctrl.mode === 'post'">
                                <md-icon class="material-icons" md-menu-align-target>delete</md-icon>
                                <span translate="measurement.toolbar.delete"></span>
                            </md-button>
                        </md-menu-item>
                        <md-menu-item>
                            <md-button ng-click="" ng-disabled="true">
                                <md-icon class="material-icons" md-menu-align-target>settings</md-icon>
                                <span translate="measurement.toolbar.settings"></span>
                            </md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>
                <h2 translate="{{$ctrl.activity.sport}}"></h2>
                <span flex></span>
                <md-button class="md-icon-button" ng-click="$ctrl.onCancel()">
                    <md-tooltip md-direction="left">{{'measurement.toolbar.attach' | translate}}</md-tooltip>
                    <md-icon class="material-icons" aria-label="Close dialog">attach_file</md-icon>
                </md-button>
                <md-button class="md-icon-button" ng-click="$ctrl.onCancel()">
                    <md-tooltip md-direction="left">{{'measurement.toolbar.close' | translate}}</md-tooltip>
                    <md-icon class="material-icons" aria-label="Close dialog">close</md-icon>
                </md-button>
            </div>
        </md-toolbar>
        <section class="overview-content" ng-if="$ctrl.isLoadingDetails"
                 flex="none" layout="column" layout-align="center center" layout-fill
                 style="background-color: whitesmoke">
            <img flex src="/assets/icon/ripple.svg" width="60" height="60"/>
            <p>Загрузка данных....</p>
        </section>
        <section flex="none" class="overview-content" layout="column"
                 ng-init="showChart = true; showTable = true" ng-if="!$ctrl.isLoadingDetails">

            <header flex="none" class="map" layout="row" layout-align="start center"
                    ng-if="$ctrl.activity.isRouteExist">
                <md-icon class="material-icon">directions</md-icon>
                <p class="md-body-2" translate>Карта</p>
                <span flex></span>
                <md-button class="md-icon-button"
                           ng-click="$ctrl.toggleMap()">
                    <md-icon class="md-secondary material-icon md-dark"
                             ng-bind="$ctrl.showMap ? 'expand_more': 'expand_less'"></md-icon>
                </md-button>
            </header>
            <activity-route flex ng-if="$ctrl.showMap && $ctrl.activity.isRouteExist"
                            class="map activity-route"
                            data="$ctrl.activity.route" select="$ctrl.select" zoom-enabled="true" layer-enabled="true">
            </activity-route >
            <md-divider ng-if="showChart"></md-divider>
            <header flex="none" layout="row" layout-align="start center">
                <md-icon class="material-icon">multiline_chart</md-icon>
                <p class="md-body-2" translate>График</p>
                <span flex></span>
                <md-button class="md-icon-button" ng-click="showChart = !showChart">
                    <md-icon class="md-secondary material-icon md-dark"
                             ng-bind="showChart ? 'expand_more': 'expand_less'"></md-icon>
                </md-button>
            </header>
            <div flex="auto" class="chart" ng-if="showChart">График</div>

            <md-divider></md-divider>
            <header flex="none" layout="row" layout-align="start center">
                <md-icon class="material-icon">format_list_numbered</md-icon>
                <p class="md-body-2" translate>Отрезки</p>
                <span flex></span>
                <md-button class="md-icon-button" ng-click="showTable = !showTable">
                    <md-icon class="md-secondary material-icon md-dark"
                             ng-bind="showTable ? 'expand_more': 'expand_less'"></md-icon>
                </md-button>
            </header>
            <measure-split-table flex="auto" layout-fill ng-if="showTable"
                                 class="chart measure-split-table"
                                 splits="$ctrl.activity.intervalL"
                                 sport="$ctrl.activity.sportBasic"></measure-split-table>

        </section>
    </section>

    <section class="details" flex="none" layout-fill layout="column" style="background-color: indianred"
             ng-class="{'single': $ctrl.mode === 'post' || !$ctrl.activity.hasDetails}">
        <md-toolbar flex="none" class="{{$ctrl.activity.status}}">
            <div class="md-toolbar-tools" ng-if="!$ctrl.$mdMedia('gt-sm') || $ctrl.mode === 'post' || !$ctrl.activity.hasDetails">
                <md-menu md-position-mode="target-right target" md-offset="0 60" md-position-mode="target-right target">
                    <md-button class="md-icon-button" ng-click="$mdOpenMenu($event)"
                               aria-label="User">
                        <md-icon class="material-icons">menu</md-icon>
                    </md-button>
                    <md-menu-content width="4">
                        <md-menu-item>
                            <md-button ng-click="$ctrl.onDelete()" ng-disabled="$ctrl.mode === 'post'">
                                <md-icon class="material-icons" md-menu-align-target>delete</md-icon>
                                <span translate="measurement.toolbar.delete"></span>
                            </md-button>
                        </md-menu-item>
                        <md-menu-item>
                            <md-button ng-click="" ng-disabled="true">
                                <md-icon class="material-icons" md-menu-align-target>settings</md-icon>
                                <span translate="measurement.toolbar.settings"></span>
                            </md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>
                <h2 translate="Тренировка"></h2>
                <!--<p class="md-caption" style="position: absolute; top: 38px; left: 62px;">13.10.1984</p>-->
                <span flex></span>
                <md-button class="md-icon-button" ng-click="$ctrl.onCancel()">
                    <md-tooltip md-direction="left">{{'measurement.toolbar.close' | translate}}</md-tooltip>
                    <md-icon class="material-icons" aria-label="Close dialog">close</md-icon>
                </md-button>
            </div>
        </md-toolbar>
        <md-content flex="auto" class="md-hue-2" layout="column">
            <md-tabs flex layout="column" layout-fill class="md-primary" ng-cloak
                     ng-class="{'coming': $ctrl.activity.status === 'coming',
                                'not-specified': $ctrl.activity.status === 'not-specified',
                                'complete': $ctrl.activity.status === 'complete',
                                'complete-warn': $ctrl.activity.status === 'complete-warn',
                                'complete-error': $ctrl.activity.status === 'complete-error' || $ctrl.activity.status === 'dismiss'}">
                <md-tab id="tab1" flex layout="column" label="Обзор">
                    <md-tab-content>
                        <section class="activity-summary" ng-if="$ctrl.mode === 'view'"
                                 ng-class="{'coming': $ctrl.activity.status === 'coming',
                                            'not-specified': $ctrl.activity.status === 'not-specified',
                                            'complete': $ctrl.activity.status === 'complete',
                                            'complete-warn': $ctrl.activity.status === 'complete-warn',
                                            'complete-error': $ctrl.activity.status === 'complete-error' || $ctrl.activity.status === 'dismiss'}">

                            <div layout="row">
                                <div flex="none" layout="row" layout-align="center center"
                                     class="bg-circle-56 bg-blue-grey-A700">
                                    <md-icon flex="none" md-svg-src="{{$ctrl.activity.sportUrl}}"
                                             class="s36 light-active"></md-icon>
                                </div>
                                <div class="summary-value md-headline font-black" flex="auto" layout="column">
                                    <div flex="none">
                                        <span>
                                            {{$ctrl.activity.durationValue |
                                            measureCalc:$ctrl.activity.sportBasic:$ctrl.activity.durationMeasure}}</span>
                                        <span ng-if="$ctrl.activity.durationMeasure !== 'movingDuration'">
                                            &nbsp{{$ctrl.activity.durationMeasure | measureUnit:$ctrl.activity.sportBasic |
                                            translate}}}}</span>
                                        </div>
                                    <div flex="none">
                                        <span>
                                            {{$ctrl.activity.intensityValue.from |
                                            measureCalc:$ctrl.activity.sportBasic:$ctrl.activity.intensityMeasure}}</span>
                                        <span>
                                            &nbsp{{$ctrl.activity.intensityMeasure | measureUnit:$ctrl.activity.sportBasic |
                                            translate}}</span>
                                    </div>
                                </div>
                            </div>
                            <div layout="row" class="md-subhead" style="margin-top: 8px">
                                <div class="summary-percent" flex="none">{{$ctrl.activity.printPercent()}}</div>
                                <div class="summary-info" flex="auto">Категория тренировки</div>
                            </div>

                            <md-fab-speed-dial ng-cloak class="animated bounceIn view" md-theme="default">
                                <md-fab-trigger>
                                    <md-button type="submit"
                                               aria-label="submit" class="md-fab md-accent"
                                               ng-click="$ctrl.mode = 'put'">
                                        <md-icon class="material-icons">edit</md-icon>
                                        <md-tooltip md-direction="left">{{'measurement.toolbar.edit' |
                                            translate}}</md-tooltip>
                                    </md-button>
                                </md-fab-trigger>
                            </md-fab-speed-dial>
                        </section>
                        <form name="$ctrl.activityForm" ng-if="$ctrl.mode !== 'view'">
                            <md-list class="md-dense slim-input bg-grey-200">
                                <md-list-item>
                                    <md-input-container class="md-block no-message" md-no-float layout="row">
                                        <md-icon flex="none" class="material-icons">directions_run</md-icon>
                                        <md-select flex ng-model="$ctrl.activity.header.activityType.id" name="type" class="icon">
                                            <md-option ng-repeat="type in $ctrl.types track by type.id"
                                                       value="{{::type.id}}">{{::type.code}}</md-option>
                                        </md-select>
                                        <div ng-messages="$ctrl.activityForm.type.$error" role="alert">
                                            <div ng-message-exp="['required']"
                                                 translate="form.required">
                                            </div>
                                            <div ng-message-exp="['minlength', 'maxlength']"
                                                 translate="form.rangeStr" translate-values="{min:2, max:100}">
                                            </div>
                                        </div>
                                    </md-input-container>
                                </md-list-item>
                                <md-list-item>
                                    <md-input-container class="md-block no-message" md-no-float>
                                        <md-icon class="material-icons">tune</md-icon>
                                        <md-select ng-model="$ctrl.activity.header.activityCategory.id" name="category" class="icon">
                                            <md-option ng-repeat="category in $ctrl.categories | filter:{activityTypeId: $ctrl.activity.header.activityType.id} track by category.id"
                                                       value="{{::category.id}}">{{::category.code}}</md-option>
                                        </md-select>
                                        <div ng-messages="$ctrl.publicForm.firstName.$error" role="alert">
                                            <div ng-message-exp="['required']"
                                                 translate="form.required">
                                            </div>
                                            <div ng-message-exp="['minlength', 'maxlength']"
                                                 translate="form.rangeStr" translate-values="{min:2, max:100}">
                                            </div>
                                        </div>
                                    </md-input-container>
                                </md-list-item>
                                <md-list-item layout="row" layout-align="start center" style="margin-bottom: 20px">
                                    <md-input-container flex="50" class="no-message" md-no-float>
                                        <md-icon flex="none" class="material-icons" style="left: 0px">tune</md-icon>
                                        <md-datepicker flex="auto" ng-model="$ctrl.activity._dateStart"
                                                       name="dateStart" md-hide-icons="calendar" style="margin-left: 56px"></md-datepicker>
                                        <div ng-messages="$ctrl.publicForm.dateStart.$error">
                                            <div ng-message="valid">The entered value is not a date!</div>
                                        </div>
                                    </md-input-container>
                                    <div flex="5" ></div>
                                    <md-input-container flex="45" class="no-message" md-no-float>
                                        <input type="time" name="uri" class=""
                                               ng-model="$ctrl.user.public.uri"
                                               ng-disabled="false">
                                    </md-input-container>
                                </md-list-item>
                            </md-list>
                            <md-fab-speed-dial ng-if="$ctrl.mode === 'post' || $ctrl.mode === 'put'"
                                               ng-cloak class="animated bounceIn" md-theme="default">
                                <md-fab-trigger>
                                    <md-button type="submit"
                                               aria-label="submit" class="md-fab md-accent"
                                               ng-disabled="!$ctrl.activityForm.$dirty"
                                               ng-class="{'md-warn': !$ctrl.activityForm.$valid}"
                                               ng-click="$ctrl.activityForm.$valid ? $ctrl.onSave() : null">
                                        <md-icon class="material-icons">save</md-icon>
                                        <md-tooltip md-direction="left">{{'measurement.toolbar.save' | translate}}</md-tooltip>
                                    </md-button>
                                </md-fab-trigger>
                            </md-fab-speed-dial>
                        </form>
                            <md-divider></md-divider>
                            <md-list class="md-dense">
                                    <activity-assignment class="activity-assignment"
                                                         plan="$ctrl.activity.intervalPW"
                                                         actual="$ctrl.activity.intervalW.calcMeasures"
                                                         sport="$ctrl.activity.sportBasic"
                                                         editable="$ctrl.mode !== 'view'"
                                                         on-change="$ctrl.updateAssignment(plan,actual,valid)">
                                    </activity-assignment>
                                <md-list-item style="margin-bottom: 20px">
                                    <md-input-container flex class="md-block no-message">
                                        <md-icon class="material-icons">event_note</md-icon>
                                        <label translate="Установка тренера" class="icon"></label>
                                        <textarea ng-model="$ctrl.activity.intervalPW.trainersPrescription"
                                                  class="icon" name="trainersPrescription"
                                                  rows="1" md-select-on-focus></textarea>
                                    </md-input-container>
                                </md-list-item>
                            </md-list>
                    </md-tab-content>
                </md-tab>
                <md-tab id="tab4" label="Детали" layout-fill layout-wrap
                        ng-if="$ctrl.activity.hasDetails">
                    <md-tab-content layout-fill layout-column>
                        <measures-avg-table flex="none" class="measures-avg-table"
                                            measures="$ctrl.activity.intervalW.calcMeasures"
                                            sport="$ctrl.activity.sportBasic"></measures-avg-table>

                        <measure-main-button flex="none" class="measure-main-button"
                                             measures="$ctrl.activity.intervalW.calcMeasures"
                                             sport="$ctrl.activity.sportBasic"></measure-main-button>

                        <activity-peaks flex="auto" class="activity-peaks"
                                        peaks="$ctrl.peaks" sport="$ctrl.activity.sportBasic">
                        </activity-peaks>

                    </md-tab-content>
                </md-tab>
                <md-tab id="tab2" flex layout="column" label="Зоны">
                    <md-tab-content>
                        View for Item #2 <br/>
                        data.selectedIndex = 1;
                    </md-tab-content>
                </md-tab>
                <md-tab id="tab3" label="Чат">
                    <md-tab-content>
                        View for Item #3 <br/>
                        data.selectedIndex = 2;
                    </md-tab-content>
                </md-tab>

            </md-tabs>
        </md-content>
    </section>







