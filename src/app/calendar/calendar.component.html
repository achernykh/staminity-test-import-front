<div class="application">
    <div hide-md class="margin-left"></div>
    <section class="application-body">

        <section class="application-toolbar" hide-xs hide-sm>
            <md-button  ng-click="$ctrl.toPrevWeek()" class="md-icon-button" aria-label="Settings" style="margin: 0px">
                <md-icon class="material-icons md-18" aria-label="Back">navigate_before</md-icon>
            </md-button>
            <md-button ng-click="$ctrl.toNextWeek()" class="md-icon-button" aria-label="Settings" style="margin: 0px">
                <md-icon class="material-icons md-18" aria-label="Back">navigate_next</md-icon>
            </md-button>

            <span class="md-body-2">
                {{$ctrl.currentWeek.toolbarDate}}
            </span>

            <md-datepicker ng-model="$ctrl.myDate" ng-change="$ctrl.toDate($ctrl.myDate)" class="picker">
            </md-datepicker>

            <span translate class="md-body-1">
                calendar.selectDate
            </span>

            <md-button ng-click="$ctrl.toCurrentWeek()" class="md-icon-button" aria-label="Settings" ng-init="today = 0">
                <md-icon class="material-icons" aria-label="Back">today</md-icon>
            </md-button>

            <span translate class="md-body-1">
                calendar.today
            </span>
            <md-button ng-click="$ctrl.view.compact = !$ctrl.view.compact" class="md-icon-button" aria-label="Settings">
                <md-icon class="material-icons" aria-label="View Size">view_comfy</md-icon>
            </md-button>
            <span class="md-body-1" translate>
                {{$ctrl.view.compact ? 'calendar.compact' : 'calendar.details'}}
            </span>

        </section>
        <section id="calendar" class="content animated zoomIn">

            <!-- weekdays panel: start -->
            <md-toolbar class=" calendar-header md-primary md-whiteframe-1dp" hide show-gt-sm>
                <div ng-repeat="day in $ctrl.weekdayNames track by $index" class="day md-caption">{{::day}}</div>
                <div hide show-gt-md class="total md-caption">Итоги</div>
            </md-toolbar>

            <!-- grid: start -->
            <section class="calendar-grid bg-grey-200"
                     scroll-container
                     on-scroll-hit-top="$ctrl.up(1)"
                     on-scroll-hit-bottom="$ctrl.down(1)"
                     scroll-keep-position="{{'#hotfix' + $ctrl.currentWeek.anchor}}">
                <!-- grid-week: start -->
                <div ng-repeat="week in $ctrl.calendar track by week.anchor"
                     style=""
                     id="hotfix{{::week.anchor}}"
                     ng-mouseover="$ctrl.setCurrentWeek(week)"
                     class="calendar-week calendar__week"
                     ng-class="{'calendar__week--current': week.sid == $ctrl.currentWeek.sid, 'calendar__week--loading': week.loading}">


                    <calendar-day
                            ng-repeat="day in week.subItem track by day.key"
                            ng-mouseover="accentDay=true" ng-mouseleave="accentDay=false"
                            ng-init="accent=false"
                            ng-class="{select: day.selected}"
                            selected="day.selected"
                            accent="accentDay"
                            data="day.data"
                            on-select="day.selected = !day.selected">
                    </calendar-day>

                    <calendar-total
                            hide show-gt-md
                            class="md-caption summary"
                            ng-mouseover="accentTotal=true" ng-mouseleave="accentTotal=false"
                            ng-init="accent=false"
                            ng-class="{select: day.selected}"
                            selected="week.selected"
                            accent="accentTotal"
                            update="week.changes"
                            week="week"
                            on-toggle="$ctrl.onToggleWeek(sid, value)">
                        <div class="md-body-1">Неделя {{$index}}</div>
                    </calendar-total>

                </div>
                <!-- grid-week: end -->

                <div class="scroll__bottom-pad" style="height:100%"></div>

            </section>
            <!-- grid-weekdays: end -->

            <!-- Fab button -->
            <md-button hide hide-gt-sm class="md-position-fab md-fab md-primary md-icon-button" aria-label="Add task">
                <md-icon class="material-icons" aria-label="Add task">add_circle_outline</md-icon>
            </md-button>

        </section>

    </section>
    <!-- common right margin -->
    <div hide-md class="margin-right"></div>
</div>

<md-fab-speed-dial  ng-init="isOpen = false" md-open="isOpen" md-direction="left" hide-gt-sm class="md-scale">
    <md-fab-trigger>
        <md-button aria-label="menu" class="md-fab md-accent">
            <md-icon class="material-icons">add</md-icon>
        </md-button>
    </md-fab-trigger>

    <md-fab-actions>
        <md-button aria-label="Events" class="md-fab md-raised md-mini" ng-click="$ctrl.onAddEvent($event)">
            <md-icon class="material-icons md-inactive" aria-label="Events">weekend</md-icon>
        </md-button>
        <md-button aria-label="Measures" class="md-fab md-raised md-mini" ng-click="$ctrl.onAddMeasurement($event)">
            <md-icon class="material-icons" aria-label="Measures">straighten</md-icon>
        </md-button>
        <md-button aria-label="Activity" class="md-fab md-raised md-mini" ng-click="$ctrl.onAddActivity($event)">
            <md-icon class="material-icons" aria-label="Activity">directions_run</md-icon>
        </md-button>
    </md-fab-actions>
</md-fab-speed-dial>


