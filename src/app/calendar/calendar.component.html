<!-- common section -->
<application-frame class='{{$ctrl.view.style}}'>
    <div class="app-layer">
        <!-- common left margin -->
        <div hide-md></div>
        <div class="body">
            <div>

                <!-- application section: start -->
                <div style="height: 100%; width: 100%">
                    <!--    toolbar: start  -->
                    <div hide-xs hide-sm class="app-toolbar">
                        <md-button class="md-icon-button md-primary" aria-label="Settings"
                                   ng-click="$ctrl.gotoAnchor($ctrl.currentWeek.sid - 1)">
                            <md-icon class="material-icons md-18" aria-label="Back">navigate_before</md-icon>
                        </md-button>
                        <md-button class="md-icon-button md-primary" aria-label="Settings"
                                   ng-click="$ctrl.gotoAnchor($ctrl.currentWeek.sid + 1)">
                            <md-icon class="material-icons md-18" aria-label="Back">navigate_next</md-icon>
                        </md-button>
                        
                        <span class="md-title">{{$ctrl.currentWeek.toolbarDate}}</span>

                        <md-button class="md-icon-button md-primary" aria-label="Settings"
                                   ng-init="today = 0"
                                   ng-click="$ctrl.gotoAnchor(today)">
                            <md-icon class="material-icons" aria-label="Back">today</md-icon>
                        </md-button>

                        <span class="md-body-1" translate class="md-caption">app.calendar.today</span>
                        <md-button class="md-icon-button md-primary" aria-label="Settings"
                                   ng-click="$ctrl.view.compact = !$ctrl.view.compact">
                            <md-icon class="material-icons" aria-label="View Size">view_comfy</md-icon>
                        </md-button>
                        <span class="md-body-1">{{!viewCompact ? 'View compact' : 'View details'}}</span>
                    </div>
                    <!-- toolbar: end  -->

                    <!-- calendar: start -->
                    <div style="width: 100%; max-width: 1400px">
                        <section id="calendar" class="app-body animated zoomIn" style="width: 100%;">

                            <!-- weekdays panel: start -->
                            <md-toolbar hide show-gt-sm
                                        class="md-primary"
                                        style="min-height: 32px; display: block; line-height: 32px;">
                                    <div ng-repeat="day in $ctrl.weekdayNames track by $index"
                                        style="display:inline-block; width: 12%; vertical-align:top"    
                                         class="md-caption weekday">{{::day}}</div>
                                    <div hide show-gt-md
                                        style="display:inline-block; width: 12%; vertical-align:top"
                                         class="md-caption weekday">Итоги</div>
                            </md-toolbar>
                            
                            <!-- grid: start -->
                            <md-content style="position: fixed; bottom: 0; top: 132px; left: 0; right: 0; z-index: 100; overflow-y: scroll" class="calendar-grid" 
                                scroll-container
                                scroll-hit-padding="500"
                                on-scroll-hit-top="$ctrl.up(1)"
                                on-scroll-hit-bottom="$ctrl.down(1)"
                                on-scroll-container-not-overflown="$ctrl.up(1); $ctrl.down(1)"
                                scroll-keep-position>

                                <!-- grid-week: start -->
                                <div ng-repeat="week in $ctrl.calendar track by week.sid"
                                     style="display:block;"
                                     id="week{{::week.sid}}"
                                     on-scroll-current-item="$ctrl.setCurrentWeek(week)"
                                     class="week calendar__week"
                                     ng-class="{'calendar__week--current': week.sid == $ctrl.currentWeek.sid, 'calendar__week--loading': week.loading}">
                                    
                                    <calendar-day 
                                                  ng-repeat="day in week.subItem track by day.key"
                                                  ng-mouseover="accentDay=true" ng-mouseleave="accentDay=false"
                                                  ng-init="accent=false"
                                                  ng-class="{select: day.selected}"
                                                  selected="day.selected"
                                                  accent="accentDay"
                                                  data="day.data"
                                                  on-select="day.selected = !day.selected">
                                    </calendar-day>

                                    <!-- grid-weektotals: start -->

                                    <calendar-total 
                                                    hide show-gt-md
                                                    class="md-caption summary"
                                                    ng-mouseover="accentTotal=true" ng-mouseleave="accentTotal=false"
                                                    ng-init="accent=false"
                                                    ng-class="{select: day.selected}"
                                                    selected="week.selected"
                                                    accent="accentTotal"
                                                    update="week.changes"
                                                    week="week"
                                                    on-toggle="$ctrl.onToggleWeek(sid, value)">
                                        <div class="md-body-1">Неделя {{$index}}</div>
                                    </calendar-total>
                                    <!-- grid-weektotals: end -->
                                    
                                </div>
                                <!-- grid-week: end -->
                                
                            </md-content>
                            <!-- grid-weekdays: end -->

                            <!-- Fab button -->
                            <md-button hide hide-gt-sm class="md-position-fab md-fab md-primary md-icon-button" aria-label="Add task">
                                <md-icon class="material-icons" aria-label="Add task">add_circle_outline</md-icon>
                            </md-button>

                         </section>
                    </div>
                    <!-- calendar: end -->

                    <div hide show-gt-md class="footer"></div>
                </div>
                <!-- application section: end -->
            </div>
        </div>
        <!-- common right margin -->
        <div hide-md></div>
    </div>
</application-frame>
<!-- end of common section -->

