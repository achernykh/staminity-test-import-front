<application-frame class="athletes">

    <md-card ng-if="!$ctrl.isMobileLayout()">
        <div layout="row" layout-align="center center" class="athletes-actions">
            <span flex class="md-title">Все ({{ $ctrl.getRows().length }})</span>
            <md-input-container style="width: {{$ctrl.showSearch? '300px' : '0'}}; padding:0; margin: 0;" class="animated"> 
                <input ng-model="$ctrl.search" ng-if="$ctrl.showSearch" auto-focus ng-blur="!$ctrl.search && ($ctrl.showSearch = false)"/> 
            </md-input-container>
            <md-button class="athletes-button md-icon-button" ng-click="$ctrl.showSearch = !$ctrl.showSearch">
                <md-icon class="material-icons">search</md-icon>
            </md-button>
            <md-button class="athletes-button md-icon-button" ng-click="$ctrl.invite($event)">
                <md-icon class="material-icons">group_add</md-icon>
            </md-button>

        </div>
        <md-toolbar class="athletes-toolbar md-table-toolbar md-default md-subhead" ng-if="$ctrl.checked.length" layout="row" layout-align="center center">
            <span flex>{{ 'athletes.selected' | translate:{count:$ctrl.checked.length} }}</span>
            <md-button class="md-primary md-icon-button" ng-if="$ctrl.isEditTariffsAvailable()" ng-click="$ctrl.editTariffs()">
                <md-tooltip md-direction="bottom">Тарифы</md-tooltip>
                <md-icon class="material-icons">account_balance_wallet</md-icon>
            </md-button>
            <md-button class="md-primary md-icon-button" ng-if="$ctrl.isRemoveAvailable()" ng-click="$ctrl.remove()"> 
                <md-tooltip md-direction="bottom">Удалить</md-tooltip>
                <md-icon class="material-icons">delete</md-icon> 
            </md-button>
        </md-toolbar>
        <md-table-container>
            <table md-table md-row-select multiple ng-model="$ctrl.checked">
                <thead md-head md-order="$ctrl.orderBy">
                    <tr md-row>
                        <th md-column md-order-by="sort.username"><span>Cпортсмен</span></th>
                        <th md-column md-order-by="sort.club"><span>Клуб</span></th>
                        <th md-column md-order-by="sort.tariff"><span>Тариф</span></th>
                        <th md-column md-order-by="sort.city"><span>Город</span></th>
                        <th md-column md-order-by="sort.ageGroup"><span>Возрастная группа</span></th>
                    </tr>
                </thead>
                <tbody md-body>
                    <tr md-row md-select="member" md-auto-select ng-repeat="member in $ctrl.getRows()">
                        <td md-cell>
                            <md-button class="athletes-username" ui-sref="user({uri: member.userProfile.public.uri})">
                                <userpic profile="member.userProfile" is-premium="$ctrl.isPremium(member)"></userpic>
                                {{ member.userProfile | username }}
                            </md-button>
                        </td>
                        <td md-cell>
                            <span ng-if="member.clubs">
                                <span ng-repeat="club in member.clubs">
                                    {{club.public.name}}
                                </span>
                            </span>
                            <span ng-if="!member.clubs"> - <span>
                        </td>
                        <td md-cell>
                            <span ng-repeat="tariff in member.userProfile.billing" class="athletes-row-tariffs">
                                {{tariff.tariffCode}} 
                                <span ng-if="tariff.userProfilePayer.userId === $ctrl.user.userId" class="badge">byCoach </span>
                            </span>
                            <span ng-if="!member.userProfile.billing || !member.userProfile.billing.length">-</span>
                        </td>
                        <td md-cell>{{member.userProfile.city}}</td>
                        <td md-cell>{{member.userProfile | ageGroup}}</td>
                    </tr>
                </tbody>
            </table>
        </md-table-container>
    </md-card>
    

    <div ng-if="$ctrl.isMobileLayout()">
        <md-list>
            <md-list-item layout="row" layout-align="center center">
                <md-icon class="material-icons">search</md-icon>
                <md-input-container flex> 
                    <input ng-model="$ctrl.search"/> 
                </md-input-container>
            </md-list-item>
            <md-list-item layout="row" layout-align="center center">
                <md-icon class="material-icons" class="athletes-tune-icon">tune</md-icon>
                <span flex>Все ({{$ctrl.rows.length}})</span>
            </md-list-item>
            <md-list-item ng-repeat="member in $ctrl.getRows()" layout="row" layout-align="center center">
                <userpic profile="member.userProfile" is-premium="$ctrl.isPremium(member)"></userpic>
                <span ui-sref="user({uri: member.userProfile.public.uri})" flex>{{ member.userProfile | username }}</span>
                <md-icon class="material-icons md-secondary" ng-click="$ctrl.showActions(member)">more_vert</md-icon>
            </md-list-item>
        </md-list>
    </div>

</application-frame>

